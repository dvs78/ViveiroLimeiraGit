(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();function q(e,t,a){let i=Array.from(new Map(e.map(n=>[n[a],n])).values());i.sort((n,o)=>n[a].localeCompare(o[a]));for(const n of i){const o=document.createElement("option");o.id=n.id,o.value=n[a],o.textContent=n[a],t.appendChild(o)}}function le(e){return Number(e.trim().replace(/\./g,""))||0}function T(e){let t=e.value;t=t.replace(",",".");const a=parseFloat(t);isNaN(a)?e.value="":e.value=a.toFixed(2)}function V(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var a=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};a.prototype=t.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(a,i,n.get?n:{enumerable:!0,get:function(){return e[i]}})}),a}var K={},$={exports:{}};const ce=new Proxy({},{get(e,t){throw new Error(`Module "" has been externalized for browser compatibility. Cannot access ".${t}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),de=Object.freeze(Object.defineProperty({__proto__:null,default:ce},Symbol.toStringTag,{value:"Module"})),se=V(de),ue=new Proxy({},{get(e,t){throw new Error(`Module "path" has been externalized for browser compatibility. Cannot access "path.${t}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),me=Object.freeze(Object.defineProperty({__proto__:null,default:ue},Symbol.toStringTag,{value:"Module"})),pe=V(me),ve=new Proxy({},{get(e,t){throw new Error(`Module "os" has been externalized for browser compatibility. Cannot access "os.${t}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),fe=Object.freeze(Object.defineProperty({__proto__:null,default:ve},Symbol.toStringTag,{value:"Module"})),ge=V(fe),he=new Proxy({},{get(e,t){throw new Error(`Module "crypto" has been externalized for browser compatibility. Cannot access "crypto.${t}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),Ee=Object.freeze(Object.defineProperty({__proto__:null,default:he},Symbol.toStringTag,{value:"Module"})),ye=V(Ee),be="16.5.0",_e={version:be};var Y;function Ne(){if(Y)return $.exports;Y=1;var e={};const t=se,a=pe,i=ge,n=ye,l=_e.version,v=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function b(r){const u={};let s=r.toString();s=s.replace(/\r\n?/mg,`
`);let p;for(;(p=v.exec(s))!=null;){const h=p[1];let c=p[2]||"";c=c.trim();const m=c[0];c=c.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),m==='"'&&(c=c.replace(/\\n/g,`
`),c=c.replace(/\\r/g,"\r")),u[h]=c}return u}function N(r){const u=k(r),s=g.configDotenv({path:u});if(!s.parsed){const m=new Error(`MISSING_DATA: Cannot parse ${u} for an unknown reason`);throw m.code="MISSING_DATA",m}const p=I(r).split(","),h=p.length;let c;for(let m=0;m<h;m++)try{const f=p[m].trim(),_=B(s,f);c=g.decrypt(_.ciphertext,_.key);break}catch(f){if(m+1>=h)throw f}return g.parse(c)}function E(r){console.log(`[dotenv@${l}][WARN] ${r}`)}function d(r){console.log(`[dotenv@${l}][DEBUG] ${r}`)}function I(r){return r&&r.DOTENV_KEY&&r.DOTENV_KEY.length>0?r.DOTENV_KEY:e.DOTENV_KEY&&e.DOTENV_KEY.length>0?e.DOTENV_KEY:""}function B(r,u){let s;try{s=new URL(u)}catch(f){if(f.code==="ERR_INVALID_URL"){const _=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw _.code="INVALID_DOTENV_KEY",_}throw f}const p=s.password;if(!p){const f=new Error("INVALID_DOTENV_KEY: Missing key part");throw f.code="INVALID_DOTENV_KEY",f}const h=s.searchParams.get("environment");if(!h){const f=new Error("INVALID_DOTENV_KEY: Missing environment part");throw f.code="INVALID_DOTENV_KEY",f}const c=`DOTENV_VAULT_${h.toUpperCase()}`,m=r.parsed[c];if(!m){const f=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${c} in your .env.vault file.`);throw f.code="NOT_FOUND_DOTENV_ENVIRONMENT",f}return{ciphertext:m,key:p}}function k(r){let u=null;if(r&&r.path&&r.path.length>0)if(Array.isArray(r.path))for(const s of r.path)t.existsSync(s)&&(u=s.endsWith(".vault")?s:`${s}.vault`);else u=r.path.endsWith(".vault")?r.path:`${r.path}.vault`;else u=a.resolve(process.cwd(),".env.vault");return t.existsSync(u)?u:null}function j(r){return r[0]==="~"?a.join(i.homedir(),r.slice(1)):r}function re(r){!!(r&&r.debug)&&d("Loading env from encrypted .env.vault");const s=g._parseVault(r);let p=e;return r&&r.processEnv!=null&&(p=r.processEnv),g.populate(p,s,r),{parsed:s}}function oe(r){const u=a.resolve(process.cwd(),".env");let s="utf8";const p=!!(r&&r.debug);r&&r.encoding?s=r.encoding:p&&d("No encoding is specified. UTF-8 is used by default");let h=[u];if(r&&r.path)if(!Array.isArray(r.path))h=[j(r.path)];else{h=[];for(const _ of r.path)h.push(j(_))}let c;const m={};for(const _ of h)try{const O=g.parse(t.readFileSync(_,{encoding:s}));g.populate(m,O,r)}catch(O){p&&d(`Failed to load ${_} ${O.message}`),c=O}let f=e;return r&&r.processEnv!=null&&(f=r.processEnv),g.populate(f,m,r),c?{parsed:m,error:c}:{parsed:m}}function ne(r){if(I(r).length===0)return g.configDotenv(r);const u=k(r);return u?g._configVault(r):(E(`You set DOTENV_KEY but you are missing a .env.vault file at ${u}. Did you forget to build it?`),g.configDotenv(r))}function ae(r,u){const s=Buffer.from(u.slice(-64),"hex");let p=Buffer.from(r,"base64");const h=p.subarray(0,12),c=p.subarray(-16);p=p.subarray(12,-16);try{const m=n.createDecipheriv("aes-256-gcm",s,h);return m.setAuthTag(c),`${m.update(p)}${m.final()}`}catch(m){const f=m instanceof RangeError,_=m.message==="Invalid key length",O=m.message==="Unsupported state or unable to authenticate data";if(f||_){const D=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw D.code="INVALID_DOTENV_KEY",D}else if(O){const D=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw D.code="DECRYPTION_FAILED",D}else throw m}}function ie(r,u,s={}){const p=!!(s&&s.debug),h=!!(s&&s.override);if(typeof u!="object"){const c=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw c.code="OBJECT_REQUIRED",c}for(const c of Object.keys(u))Object.prototype.hasOwnProperty.call(r,c)?(h===!0&&(r[c]=u[c]),p&&d(h===!0?`"${c}" is already defined and WAS overwritten`:`"${c}" is already defined and was NOT overwritten`)):r[c]=u[c]}const g={configDotenv:oe,_configVault:re,_parseVault:N,config:ne,decrypt:ae,parse:b,populate:ie};return $.exports.configDotenv=g.configDotenv,$.exports._configVault=g._configVault,$.exports._parseVault=g._parseVault,$.exports.config=g.config,$.exports.decrypt=g.decrypt,$.exports.parse=g.parse,$.exports.populate=g.populate,$.exports=g,$.exports}var M,z;function $e(){if(z)return M;z=1;var e={};const t={};return e.DOTENV_CONFIG_ENCODING!=null&&(t.encoding=e.DOTENV_CONFIG_ENCODING),e.DOTENV_CONFIG_PATH!=null&&(t.path=e.DOTENV_CONFIG_PATH),e.DOTENV_CONFIG_DEBUG!=null&&(t.debug=e.DOTENV_CONFIG_DEBUG),e.DOTENV_CONFIG_OVERRIDE!=null&&(t.override=e.DOTENV_CONFIG_OVERRIDE),e.DOTENV_CONFIG_DOTENV_KEY!=null&&(t.DOTENV_KEY=e.DOTENV_CONFIG_DOTENV_KEY),M=t,M}var R,U;function Ie(){if(U)return R;U=1;const e=/^dotenv_config_(encoding|path|debug|override|DOTENV_KEY)=(.+)$/;return R=function(a){return a.reduce(function(i,n){const o=n.match(e);return o&&(i[o[1]]=o[2]),i},{})},R}var G;function Oe(){return G||(G=1,function(){Ne().config(Object.assign({},$e(),Ie()(process.argv)))}()),K}Oe();const De="https://viveirolimeiragit.onrender.com/api";async function Q(){try{const e=await fetch(`${De}/mudas`);if(!e.ok)throw new Error("Erro ao buscar mudas");return await e.json()}catch(e){return console.error("Erro ao buscar mudas:",e),[]}}let P=await Q();P.sort((e,t)=>e.cultivar.localeCompare(t.cultivar));const we="https://viveirolimeiragit.onrender.com/api";async function Be(){try{const e=await fetch(`${we}/pedidos`);if(!e.ok)throw new Error("Erro ao buscar pedidos");return await e.json()}catch(e){return console.error("Erro ao buscar pedidos:",e),[]}}const J="https://viveirolimeiragit.onrender.com/api";async function Te(e,t,a,i,n,o,l,v,b,N,E){const d={id:e,idPedido:t,ano:a,cultivar:i,semente:n,embalagem:o,precoMuda:l,desconto:v,precoMudaDesconto:b,pedido:N,precoMudaTotal:E},I=await fetch(`${J}/carrinho`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});try{if(!I.ok)throw alert("Erro de resposta"),new Error("Erro de resposta");I.ok?alert("Carrinho adicionado!!!!"):alert("Erro ao adicionar carrinho!!!!")}catch{alert("Erro ao adicionar carrinho, catch!!!!")}}async function Le(){try{const e=await fetch(`${J}/carrinho`,{method:"DELETE"});if(!e.ok){const t=await e.json();alert("Erro ao excluir carrinho: "+t.message)}}catch(e){console.error(e),alert("Erro de conexão com o servidor.")}}let y={},H=[];const F=document.getElementById("index-produto-total"),A=document.getElementById("index-valor-total");function Ce(){document.getElementById("carrinho").style.right="0rem"}function xe(){document.getElementById("carrinho").style.right="-40rem"}function Ve(){const e=document.getElementById("fechar-carrinho"),t=document.getElementById("abrir-carrinho");e.addEventListener("click",xe),t.addEventListener("click",Ce)}function Pe(e){delete y[e];for(const t in y)X(t);Me()}function W(e){e||(y[e]="");let t=P.find(d=>d.id===e);delete t.estoque,delete t.producao,H.push(t);const a=document.getElementById("produtos-carrinho"),i=document.createElement("article");i.classList.add("cartao-produto-carrinho");const n=`
      <i id="remover-produto-${t.id}" class="fechar-produto-carrinho fa-solid fa-circle-xmark"></i>
      <div class="container-article-carrinho">
      <div class="cultivar-embalagem-carrinho">
        <p id="cultivar-${t.id}" class="cultivar-carrinho">${t.cultivar}</p>
        <p id="embalagem-${t.id}" class="embalagem-carrinho">${t.embalagem}</p>
      </div>

      <div class="valor-adicionar-carrinho">
      <div>
        <label for="valor-muda-${t.id}">R$_muda</label>
        <input type="text" id="valor-muda-${t.id}" class="input-produto-carrinho valor-muda" placeholder="R$ 0,00">
        </div>

      <div>
        <label for="desconto-muda-${t.id}">Desconto (%)</label>
        <input type="text" id="desconto-muda-${t.id}" class="input-produto-carrinho desconto-muda" placeholder="0,00">
      </div>

      <div>
        <label for="valor-muda-desconto-${t.id}">Desconto (R$_muda)</label>
        <input type="text" id="valor-muda-desconto-${t.id}" class="input-produto-carrinho valor-muda-desconto" placeholder="R$ 0,00">
        </div>

      </div>

      <div class="qtde-adicionar-carrinho">
          <div>
            <label for="quantidade-${t.id}">Qtde mudas</label>
            <input type="text" id="quantidade-${t.id}" class="input-produto-carrinho" placeholder="0.0">
          </div>

          <div>
            <label for="valor-total-${t.id}">R$ total</label>
            <input type="text" id="valor-total-${t.id}" class="input-produto-carrinho" placeholder="R$ 0,00">
          </div>

          <div>
            <button id="adicionar-${t.id}" class="adicionar-produto-carrinho">Adicionar</button>
          </div>

      </div>
      </div>`;i.innerHTML=n,a.appendChild(i),document.getElementById("index-finalizar-compra").classList.remove("hidden");let l=document.getElementById(`valor-muda-${t.id}`),v=document.getElementById(`desconto-muda-${t.id}`),b=document.getElementById(`valor-muda-desconto-${t.id}`),N=document.getElementById(`valor-total-${t.id}`),E=document.getElementById(`quantidade-${t.id}`);l.addEventListener("blur",()=>{if(T(l),T(v),v.value.length===0){if(b.value=l.value,E.value.length>0){let d=E.value.replace(/\D/g,"");d=Number(d),N.value=(Number(l.value)*d).toLocaleString("pt-BR")}return}if(v.value.length>0&&(b.value=(l.value*((100-v.value)/100)).toFixed(2),E.value.length>0)){let d=E.value.replace(/\D/g,"");d=Number(d),N.value=(Number(b.value)*d).toLocaleString("pt-BR")}}),v.addEventListener("blur",()=>{if(T(l),T(v),l.value.length>0&&(b.value=(l.value*((100-v.value)/100)).toFixed(2),E.value.length>0)){let d=E.value.replace(/\D/g,"");d=Number(d),N.value=(Number(b.value)*d).toLocaleString("pt-BR")}}),E.addEventListener("input",()=>{let d=E.value.replace(/\D/g,"");d=Number(d).toLocaleString("pt-BR"),E.value=d}),E.addEventListener("blur",()=>{let d=E.value.replace(/\D/g,"");d=Number(d),N.value=(Number(b.value)*d).toLocaleString("pt-BR")}),document.getElementById(`remover-produto-${t.id}`).addEventListener("click",()=>{Pe(t.id)}),document.getElementById(`quantidade-${t.id}`).addEventListener("input",d=>{y[e]=d.target.value;let I=H.find(B=>B.id===t.id);I&&(I.pedido=d.target.value)}),document.getElementById(`adicionar-${t.id}`).addEventListener("click",()=>{X(t.id)})}function Me(){const e=document.getElementById("produtos-carrinho");e.innerHTML="";for(const t in y)console.log("idProduto",t),W(t),document.getElementById(`quantidade-${t}`).value=y[t]}function Re(e){e in y||(y[e]=0,W(e))}F.classList.add("hidden");A.classList.add("hidden");function X(e){y[e]=document.getElementById(`quantidade-${e}`).value.replace(".","");const t=parseFloat(document.getElementById(`valor-muda-${e}`).value),a=parseFloat(document.getElementById(`desconto-muda-${e}`).value),i=parseFloat(document.getElementById(`quantidade-${e}`).value);(isNaN(t)||isNaN(a)||isNaN(i)||t<0||a<0||i<0||t===0||a===0||i===0)&&alert("Por favor, digite corretamente a quantidade de mudas!!!");let n=[],o=[];for(const l in y){let v=Number(y[l]).toFixed(0);n.push(Number(v)),o.push(Number(Number(y[l]))*document.getElementById(`valor-muda-desconto-${l}`).value)}F.classList.remove("hidden"),F.innerText=`Mudas total: ${n.reduce((l,v)=>l+v,0).toLocaleString("pt-BR")}`,A.classList.remove("hidden"),A.innerText=`Valor total: R$ ${o.reduce((l,v)=>l+v,0).toLocaleString("pt-BR")}`}document.getElementById("index-finalizar-compra").addEventListener("click",async()=>{await Le();let e={id:"",idPedido:"",ano:"",semente:"",embalagem:"",cultivar:"",precoMuda:"",desconto:"",precoMudaDesconto:"",pedido:"",precoMudaTotal:""},t=await P;for(const a in y){e={};let i=document.getElementById(`quantidade-${a}`).value,n=t.filter(o=>String(o.id)===String(a));e.id=n[0].id,e.idPedido=`${n[0].idmuda}-${i}`,e.ano=n[0].ano,e.cultivar=n[0].cultivar,e.semente=n[0].semente,e.embalagem=n[0].embalagem,e.cultivar=n[0].cultivar,e.precoMuda=document.getElementById(`valor-muda-${a}`).value,e.desconto=document.getElementById(`desconto-muda-${a}`).value,e.precoMudaDesconto=document.getElementById(`valor-muda-desconto-${a}`).value,e.pedido=document.getElementById(`quantidade-${a}`).value,e.precoMudaTotal=document.getElementById(`valor-total-${a}`).value,Te(e.id,e.idPedido,e.ano,e.cultivar,e.semente,e.embalagem,e.precoMuda,e.desconto,e.precoMudaDesconto,e.pedido,e.precoMudaTotal)}window.location.href="checkout.html"});let w=await Q()??[],Se=await Be()??[];w.sort((e,t)=>e.ano!==t.ano?e.ano.localeCompare(t.ano):e.cultivar!==t.cultivar?e.cultivar.localeCompare(t.cultivar):e.semente.localeCompare(t.semente));const L=document.getElementById("ano-select"),Fe=w.filter((e,t,a)=>t===a.findIndex(i=>i.ano===e.ano)),Ae=Fe.map((e,t)=>({id:t+1,ano:e.ano}));q(Ae,L,"ano");const C=document.getElementById("cultivar-select"),qe=w.filter((e,t,a)=>t===a.findIndex(i=>i.cultivar===e.cultivar)),ke=qe.map((e,t)=>({id:t+1,cultivar:e.cultivar}));q(ke,C,"cultivar");const x=document.getElementById("embalagem-select"),je=w.filter((e,t,a)=>t===a.findIndex(i=>i.embalagem===e.embalagem)),Ke=je.map((e,t)=>({id:t+1,embalagem:e.embalagem}));q(Ke,x,"embalagem");let Z=document.getElementById("container-cultivares-select");function Ye(){Z.classList.remove("hidden"),document.getElementById("header-index").classList.add("hidden")}const ze=document.getElementById("icone-filtro");ze.addEventListener("click",Ye);function Ue(){Z.classList.add("hidden"),document.getElementById("header-index").classList.remove("hidden")}const Ge=document.getElementById("icone-fechar-filtro");Ge.addEventListener("click",Ue);let He=[L,C,x];He.forEach(e=>{e.addEventListener("change",Qe)});let ee=document.getElementById("container-cartoes"),S=document.getElementById("container-novos-cartoes");async function Qe(){S.innerHTML="",ee.remove(),S.classList.add("index-mudasbd"),console.log("selectFiltrarAno.value",L.value,"selectFiltrarCultivar",C.value,"selectFiltrarEmbalagem",x.value);let e=w;const t=L.value,a=C.value,i=x.value,n=e.filter(o=>(!t||o.ano===t)&&(!a||o.cultivar===a)&&(!i||o.embalagem===i));n.sort((o,l)=>o.ano!==l.ano?o.ano.localeCompare(l.ano):o.cultivar!==l.cultivar?o.cultivar.localeCompare(l.cultivar):o.semente.localeCompare(l.semente)),te(n,S)}function Je(e){const t=e.reduce((a,i)=>{const n=i.idmuda,o=le(i.pedido);return a[n]||(a[n]={idmuda:n,pedido:0}),a[n].pedido+=o,a},{});return Object.values(t)}let We=Je(Se);async function te(e,t){t.innerHTML="";let a=0,i=0,n=0;for(const o of await e){o.pedido=0;let l=We.find(N=>Number(N.idmuda)===Number(o.id));o.pedido=l?l.pedido:0;let v=o.producao-o.pedido;const b=`
          <div class="card-produto" data-tipo=${o.embalagem.toLowerCase()}>
            <p class="cultivar">${o.cultivar}</p>

  <p class="embalagem">${o.embalagem}</p>
            <p class="producao">Produção: ${Number(o.producao).toLocaleString("pt-BR")}</p>
            <p class="pedido">Pedido: ${Number(o.pedido).toLocaleString("pt-BR")} </p>
            <p class="estoque">Estoque: ${Number(v).toLocaleString("pt-BR")} </p>
            <button id="adicionar-${o.id}" ><i class="fa-solid fa-cart-plus"></i></button>
          </div>`;t.innerHTML+=b,a+=Number(o.producao),i+=Number(o.pedido),n+=v}document.getElementById("container-produto-soma").innerHTML=`PRODUÇÃO:
        ${Number(a).toLocaleString("pt-BR")}`,document.getElementById("container-produto-pedido").innerHTML=`PEDIDO:
        ${Number(i).toLocaleString("pt-BR")}`,document.getElementById("container-produto-estoque").innerHTML=`ESTOQUE:
        ${Number(n).toLocaleString("pt-BR")}`;for(const o of e)document.getElementById(`adicionar-${o.id}`).addEventListener("click",()=>{Re(o.id)})}te(P,ee);Ve();
